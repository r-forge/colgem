<!-- 2-type birth-death model
2 parameters: within- and between-birth rates  -->

<beast version='2.0' namespace='master.beast:beast.core.parameter'>
  <run spec='InheritanceTrajectory'
	   samplePopulationSizes="true"
	   verbosity="1"
	   simulationTime="10"
	   >
	   

	<model spec='InheritanceModel' id='model'>
	  <population spec='Population' id='Y0' populationName='Y0'/>
	  <population spec='Population' id='Y1' populationName='Y1'/>
	  
	  <reaction spec='InheritanceReaction' reactionName="birth00" rate="1">
			Y0:1 -> Y0:1 + Y0:1
	  </reaction>
	  <reaction spec='InheritanceReaction' reactionName="birth11" rate="1">
			Y1:1 ->  Y1:1 + Y1:1
	  </reaction>
	  
	  <reaction spec='InheritanceReaction' reactionName="birth01" rate=".5">
			Y0:1 ->  Y0:1 + Y1:1 
	  </reaction>
	  <reaction spec='InheritanceReaction' reactionName="birth10" rate=".5">
			Y1:1 ->  Y1:1 + Y0:1 
	  </reaction>
	  
	  <reaction spec='InheritanceReaction' reactionName="sample0" rate="1">
			Y0 -> 0
	  </reaction>
	  <reaction spec='InheritanceReaction' reactionName="sample1" rate="1">
			Y1 -> 0
	  </reaction>
	</model>
	
	<initialState spec='InitState'>
	  <populationSize spec='PopulationSize' population='@Y1' size='0'/>
	  <lineageSeed spec='Individual' population='@Y0' time="0"/> 
	</initialState>
	
	
	<output spec='NexusOutput' fileName='BDModel2type.nexus'/>
	<output spec='JsonOutput' fileName='BDModel2type.json'/>
  </run>
</beast>


<!--
b00 <- 1; b11 <- 1; b01 <- .5; b10 <- .5; d0 <- 1; d1 <-1
#Visualize output in R
require(rjson)
d <- fromJSON(file='BDModel2type.json')
plot(d$t, d$Y0, 'l', ylim=c(0, max(c(d$Y0,d$Y1))), col='blue')
lines(d$t, d$Y1, col='red')

#compare to deterministic model
require(deSolve)
dY <- function(t, y, parms, ...){
	Y0 <-  y[1] 
	Y1 <-  y[2] 
	list(unname(c(
		b00 * Y0 + b10 * Y1 - d0 * Y0,
		b11 * Y1 + b01 * Y0 - d1 * Y1
	 )))
}
y0 <- c( 1, 0)
times <- d$t
o <- ode(y0, times, dY)
lines(o[,1], o[,2], col='blue')
lines(o[,1], o[,3], col='red')


#### on log-y axes:
b00 <- 1; b11 <- 1; b01 <- .5; b10 <- .5; d0 <- 1; d1 <-1
#Visualize output in R
require(rjson)
d <- fromJSON(file='BDModel2type-7.json')
plot(d$t, d$Y0+.01, 'l', ylim=c(.01, max(c(d$Y0,d$Y1))), col='blue', log='y')
lines(d$t, d$Y1, col='red')
lines(o[,1], o[,2], col='blue')
lines(o[,1], o[,3], col='red')



-->
